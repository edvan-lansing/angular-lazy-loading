<!--
  PÃGINA USERS-LIST
  =================

  Demonstra:
  - Componentes reutilizÃ¡veis (Button, Card)
  - Service REST com Observable
  - Tratamento de erros
  - Estados de carregamento
-->

<div class="users-container">
  <h1>ğŸ‘¥ Lista de UsuÃ¡rios</h1>

  <!-- SeÃ§Ã£o de Controles -->
  <div class="controls">
    <p class="subtitle">
      Exemplo prÃ¡tico de:
      <strong>Observable + Service REST + Componentes ReutilizÃ¡veis</strong>
    </p>

    <!-- Usar componente Button reutilizÃ¡vel -->
    <app-button
      label="ğŸ”„ Recarregar"
      type="primary"
      size="medium"
      [loading]="isLoading()"
      [disabled]="isLoading()"
      (buttonClick)="onReload()"
    ></app-button>
  </div>

  <!-- Mostrar estado de carregamento -->
  @if (isLoading()) {
    <div class="loading-state">
      <p>â³ Carregando usuÃ¡rios...</p>
      <div class="spinner"></div>
    </div>
  }

  <!-- Mostrar mensagem de erro -->
  @if (errorMessage()) {
    <div class="error-state">
      <h3>âš ï¸ Erro</h3>
      <p>{{ errorMessage() }}</p>
      <app-button
        label="Tentar Novamente"
        type="danger"
        (buttonClick)="onReload()"
      ></app-button>
    </div>
  }

  <!-- Mostrar lista de usuÃ¡rios -->
  @if (!isLoading() && !errorMessage()) {
    <div class="users-grid">
      @for (user of users(); track user.id) {
        <!-- Usar componente Card reutilizÃ¡vel -->
        <app-card
          [title]="user.name"
          [subtitle]="user.email"
          [elevation]="2"
        >
          <div class="user-details">
            <!-- Email -->
            <div class="detail-row">
              <strong>ğŸ“§ Email:</strong>
              <span>{{ user.email }}</span>
            </div>

            <!-- Telefone (se houver) -->
            @if (user.phone) {
              <div class="detail-row">
                <strong>ğŸ“± Telefone:</strong>
                <span>{{ user.phone }}</span>
              </div>
            }

            <!-- Empresa (se houver) -->
            @if (user.company) {
              <div class="detail-row">
                <strong>ğŸ¢ Empresa:</strong>
                <span>{{ user.company }}</span>
              </div>
            }

            <!-- BotÃµes de AÃ§Ã£o -->
            <div class="user-actions">
              <app-button
                label="Selecionar"
                type="primary"
                size="small"
                icon="ğŸ‘‰"
                (buttonClick)="onSelectUser(user)"
              ></app-button>

              <app-button
                label="Deletar"
                type="danger"
                size="small"
                icon="ğŸ—‘ï¸"
                (buttonClick)="onDeleteUser(user)"
              ></app-button>
            </div>
          </div>
        </app-card>
      } @empty {
        <div class="empty-state">
          <p>Nenhum usuÃ¡rio encontrado</p>
        </div>
      }
    </div>
  }

  <!-- Mostrar detalhes do usuÃ¡rio selecionado -->
  @if (selectedUser(); as user) {
    <div class="selected-user-detail">
      <app-card
        [title]="'Detalhes de: ' + user.name"
        [elevation]="3"
      >
        <div class="detail-section">
          <p><strong>ID:</strong> {{ user.id }}</p>
          <p><strong>Nome:</strong> {{ user.name }}</p>
          <p><strong>Email:</strong> {{ user.email }}</p>
          @if (user.phone) {
            <p><strong>Telefone:</strong> {{ user.phone }}</p>
          }
          @if (user.company) {
            <p><strong>Empresa:</strong> {{ user.company }}</p>
          }

          <app-button
            label="Fechar"
            type="secondary"
            (buttonClick)="selectedUser() ? selectedUser.set(null) : null"
          ></app-button>
        </div>
      </app-card>
    </div>
  }
</div>
